<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geolocation API | HTML & CSS Mastery Course</title>
    <meta name="description" content="Learn how to use the Geolocation API to access the user's geographical location in web applications.">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="../../../assets/css/style.css">
</head>
<body data-page="19">
    <!-- Glowing elements for futuristic effect -->
    <div class="glow glow-1"></div>
    <div class="glow glow-2"></div>
    
    <!-- Header -->
    <header>
        <div class="container grid">
            <div class="logo">
                <img src="../../../assets/images/logo.svg" alt="HTML & CSS Mastery">
                <h1>HTML & CSS Mastery</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="../../../index.html">Home</a></li>
                    <li><a href="../basic/page1.html">HTML Basics</a></li>
                    <li><a href="../professional/page13.html" class="active">Pro HTML</a></li>
                    <li><a href="../../css/basic/page26.html">CSS Basics</a></li>
                    <li><a href="../../css/professional/page38.html">Pro CSS</a></li>
                </ul>
                <button class="menu-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </nav>
        </div>
    </header>
    
    <!-- Main Content -->
    <main>
        <div class="container grid">
            <!-- Sidebar Navigation -->
            <div class="sidebar" style="grid-column: span 3;">
                <h3>Professional HTML</h3>
                <ul>
                    <li><a href="page13.html">13. Advanced HTML Concepts</a></li>
                    <li><a href="page14.html">14. HTML5 Semantic Elements</a></li>
                    <li><a href="page15.html">15. HTML Forms Advanced</a></li>
                    <li><a href="page16.html">16. HTML Media & Graphics</a></li>
                    <li><a href="page17.html">17. HTML APIs</a></li>
                    <li><a href="page18.html">18. Web Storage</a></li>
                    <li><a href="page19.html" class="active">19. Geolocation API</a></li>
                    <li><a href="page20.html">20. Drag & Drop API</a></li>
                    <li><a href="page21.html">21. Web Workers</a></li>
                    <li><a href="page22.html">22. Server-Sent Events</a></li>
                    <li><a href="page23.html">23. WebSockets</a></li>
                    <li><a href="page24.html">24. Responsive HTML</a></li>
                    <li><a href="page25.html">25. HTML Accessibility</a></li>
                </ul>
                
                <div class="progress-container" style="margin-top: 3rem;">
                    <div class="progress-bar" style="width: 38%;"></div>
                </div>
                <p style="text-align: center;">Page 19 of 50</p>
            </div>
            
            <!-- Content Area -->
            <div class="content" style="grid-column: span 9;">
                <section class="section animate" data-animation="fade-in">
                    <h1>Geolocation API</h1>
                    
                    <div class="card">
                        <h2>Introduction to Geolocation</h2>
                        <p>The Geolocation API allows web applications to access the user's geographical location information. This powerful capability enables developers to create location-aware web applications that can provide personalized experiences based on where the user is located.</p>
                        
                        <p>With the Geolocation API, you can:</p>
                        <ul>
                            <li>Determine the user's current position (latitude and longitude)</li>
                            <li>Track the user's movement over time</li>
                            <li>Calculate distances between locations</li>
                            <li>Provide location-based services and recommendations</li>
                        </ul>
                        
                        <div class="info-box">
                            <h4>Privacy and Permissions</h4>
                            <p>The Geolocation API is a powerful feature that requires explicit user permission. Browsers will always prompt users before sharing their location with a website. This is because location data is considered sensitive personal information.</p>
                            <p>Key privacy considerations:</p>
                            <ul>
                                <li>Always explain to users why you need their location before requesting it</li>
                                <li>Only request location when necessary for your application's functionality</li>
                                <li>Provide a fallback for users who deny location access</li>
                                <li>Consider the accuracy level you actually need (high accuracy uses more battery)</li>
                                <li>Be transparent about how location data will be used and stored</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>Basic Geolocation</h2>
                        <p>The Geolocation API is accessed through the <code>navigator.geolocation</code> object. Before using it, you should check if the browser supports this feature.</p>
                        
                        <h3>Checking for Support</h3>
                        <pre><code class="language-javascript">// Check if Geolocation is supported
if ('geolocation' in navigator) {
    console.log('Geolocation is supported');
    // Proceed with using geolocation
} else {
    console.log('Geolocation is not supported');
    // Provide fallback or notify user
}</code></pre>
                        
                        <h3>Getting the Current Position</h3>
                        <p>The most basic geolocation operation is getting the user's current position using the <code>getCurrentPosition()</code> method:</p>
                        
                        <pre><code class="language-javascript">// Get current position
navigator.geolocation.getCurrentPosition(
    // Success callback
    function(position) {
        // Get coordinates from the position object
        const latitude = position.coords.latitude;
        const longitude = position.coords.longitude;
        
        console.log(`Latitude: ${latitude}, Longitude: ${longitude}`);
        
        // Do something with the location data
        displayLocation(latitude, longitude);
    },
    // Error callback
    function(error) {
        switch(error.code) {
            case error.PERMISSION_DENIED:
                console.error("User denied the request for geolocation.");
                break;
            case error.POSITION_UNAVAILABLE:
                console.error("Location information is unavailable.");
                break;
            case error.TIMEOUT:
                console.error("The request to get user location timed out.");
                break;
            case error.UNKNOWN_ERROR:
                console.error("An unknown error occurred.");
                break;
        }
    },
    // Options
    {
        enableHighAccuracy: true, // Use GPS if available
        timeout: 5000,           // Time to wait for a position (milliseconds)
        maximumAge: 0            // Don't use a cached position
    }
);</code></pre>
                        
                        <h3>Position Object Properties</h3>
                        <p>The Position object returned by the success callback contains a <code>coords</code> object with several useful properties:</p>
                        
                        <pre><code class="language-javascript">function showPosition(position) {
    console.log("Latitude: " + position.coords.latitude);
    console.log("Longitude: " + position.coords.longitude);
    console.log("Accuracy: " + position.coords.accuracy + " meters");
    
    // These properties might be undefined if the device doesn't support them
    if (position.coords.altitude !== null) {
        console.log("Altitude: " + position.coords.altitude + " meters");
        console.log("Altitude Accuracy: " + position.coords.altitudeAccuracy + " meters");
    }
    
    if (position.coords.speed !== null) {
        console.log("Speed: " + position.coords.speed + " meters/second");
    }
    
    if (position.coords.heading !== null) {
        console.log("Heading: " + position.coords.heading + " degrees");
    }
    
    console.log("Timestamp: " + position.timestamp);
}</code></pre>
                        
                        <div class="info-box">
                            <h4>Understanding Position Properties</h4>
                            <ul>
                                <li><strong>latitude</strong>: The latitude in decimal degrees</li>
                                <li><strong>longitude</strong>: The longitude in decimal degrees</li>
                                <li><strong>accuracy</strong>: The accuracy of the latitude and longitude in meters</li>
                                <li><strong>altitude</strong>: The height of the position in meters above the ellipsoid (may be null)</li>
                                <li><strong>altitudeAccuracy</strong>: The accuracy of the altitude in meters (may be null)</li>
                                <li><strong>heading</strong>: The direction of travel in degrees clockwise from true north (may be null)</li>
                                <li><strong>speed</strong>: The current ground speed in meters per second (may be null)</li>
                                <li><strong>timestamp</strong>: The time when the position was retrieved</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>Tracking Position</h2>
                        <p>In addition to getting the current position once, you can also continuously track the user's position as they move. This is useful for navigation apps, fitness trackers, or any application that needs to monitor location changes.</p>
                        
                        <h3>Watching Position</h3>
                        <pre><code class="language-javascript">// Variable to store the watch ID
let watchId;

// Start tracking location
function startTracking() {
    if ('geolocation' in navigator) {
        // Clear any existing watch
        if (watchId) {
            navigator.geolocation.clearWatch(watchId);
        }
        
        // Start a new watch
        watchId = navigator.geolocation.watchPosition(
            // Success callback
            function(position) {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                
                console.log(`Updated position - Lat: ${latitude}, Lng: ${longitude}`);
                
                // Update the user's position on a map or in your application
                updatePositionOnMap(latitude, longitude);
                
                // Calculate speed if not provided by the API
                if (position.coords.speed === null) {
                    calculateSpeed(position);
                }
            },
            // Error callback
            function(error) {
                console.error("Error tracking position:", error.message);
                
                // Handle specific errors
                switch(error.code) {
                    case error.PERMISSION_DENIED:
                        showError("Location permission denied");
                        stopTracking(); // Stop tracking if permission is denied
                        break;
                    case error.POSITION_UNAVAILABLE:
                        showError("Location unavailable");
                        break;
                    case error.TIMEOUT:
                        showError("Location request timed out");
                        break;
                    case error.UNKNOWN_ERROR:
                        showError("Unknown location error");
                        break;
                }
            },
            // Options
            {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            }
        );
        
        console.log("Location tracking started");
    } else {
        console.error("Geolocation is not supported by this browser");
    }
}

// Stop tracking location
function stopTracking() {
    if (watchId) {
        navigator.geolocation.clearWatch(watchId);
        watchId = null;
        console.log("Location tracking stopped");
    }
}

// Store previous position for calculations
let previousPosition = null;

// Calculate speed manually if not provided by the API
function calculateSpeed(currentPosition) {
    if (previousPosition) {
        // Time difference in seconds
        const timeDiff = (currentPosition.timestamp - previousPosition.timestamp) / 1000;
        
        // Distance in meters
        const distance = calculateDistance(
            previousPosition.coords.latitude,
            previousPosition.coords.longitude,
            currentPosition.coords.latitude,
            currentPosition.coords.longitude
        );
        
        // Speed in meters per second
        const speed = distance / timeDiff;
        
        console.log(`Calculated speed: ${speed.toFixed(2)} m/s`);
    }
    
    // Update previous position
    previousPosition = currentPosition;
}</code></pre>
                        
                        <h3>Calculating Distance Between Coordinates</h3>
                        <p>When tracking position, you often need to calculate the distance between coordinates. The Haversine formula is commonly used for this purpose:</p>
                        
                        <pre><code class="language-javascript">// Calculate distance between two points using the Haversine formula
function calculateDistance(lat1, lon1, lat2, lon2) {
    const R = 6371e3; // Earth's radius in meters
    const φ1 = lat1 * Math.PI / 180; // Convert to radians
    const φ2 = lat2 * Math.PI / 180;
    const Δφ = (lat2 - lat1) * Math.PI / 180;
    const Δλ = (lon2 - lon1) * Math.PI / 180;

    const a = Math.sin(Δφ / 2) * Math.sin(Δφ / 2) +
              Math.cos(φ1) * Math.cos(φ2) *
              Math.sin(Δλ / 2) * Math.sin(Δλ / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

    const distance = R * c; // Distance in meters
    return distance;
}</code></pre>
                        
                        <h3>Handling Background Tracking</h3>
                        <p>When tracking location, be aware that browsers may throttle or pause location updates when the page is in the background:</p>
                        
                        <pre><code class="language-javascript">// Handle page visibility changes
document.addEventListener('visibilitychange', function() {
    if (document.hidden) {
        // Page is hidden (in background)
        console.log("Page is in background, location updates may be throttled");
        
        // You might want to adjust tracking options or notify the user
        if (watchId) {
            // Optionally stop high-accuracy tracking to save battery
            stopTracking();
            watchId = navigator.geolocation.watchPosition(
                positionCallback, 
                errorCallback, 
                { enableHighAccuracy: false, timeout: 30000, maximumAge: 60000 }
            );
        }
    } else {
        // Page is visible again
        console.log("Page is visible, resuming normal location tracking");
        
        // Resume high-accuracy tracking if needed
        if (watchId) {
            stopTracking();
            watchId = navigator.geolocation.watchPosition(
                positionCallback, 
                errorCallback, 
                { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
            );
        }
    }
});</code></pre>
                        
                        <div class="info-box">
                            <h4>Battery Considerations</h4>
                            <p>Continuous location tracking, especially with high accuracy, can significantly drain the device's battery. Consider these strategies to minimize battery impact:</p>
                            <ul>
                                <li>Only use <code>enableHighAccuracy: true</code> when you really need precise location</li>
                                <li>Adjust the frequency of updates based on the application needs</li>
                                <li>Stop tracking when the user is not actively using the feature</li>
                                <li>Use a higher <code>maximumAge</code> value to allow cached positions</li>
                                <li>Consider using a lower accuracy when the device is stationary</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>Geolocation Options</h2>
                        <p>Both <code>getCurrentPosition()</code> and <code>watchPosition()</code> accept an options object that allows you to customize how location data is retrieved.</p>
                        
                        <h3>Available Options</h3>
                        <pre><code class="language-javascript">const options = {
    enableHighAccuracy: true,  // Use GPS if available (more battery consumption)
    timeout: 5000,             // Time to wait for a position in milliseconds
    maximumAge: 0              // Maximum age of a cached position in milliseconds
};

navigator.geolocation.getCurrentPosition(
    successCallback,
    errorCallback,
    options
);</code></pre>
                        
                        <h3>Understanding the Options</h3>
                        <ul>
                            <li><strong>enableHighAccuracy</strong>: When set to <code>true</code>, the device will attempt to provide the most accurate position it can. This might use GPS on mobile devices, which consumes more battery power.</li>
                            <li><strong>timeout</strong>: The maximum time (in milliseconds) that the device is allowed to take to return a position. If the timeout expires, the error callback is invoked.</li>
                            <li><strong>maximumAge</strong>: The maximum age (in milliseconds) of a cached position that is acceptable to return. If set to 0, the device must attempt to retrieve a new position. If set to Infinity, the device must return a cached position regardless of its age.</li>
                        </ul>
                        
                        <h3>Choosing Appropriate Options</h3>
                        <p>Different scenarios call for different option configurations:</p>
                        
                        <pre><code class="language-javascript">// High accuracy for navigation apps
const navigationOptions = {
    enableHighAccuracy: true,
    timeout: 10000,
    maximumAge: 0
};

// Balanced options for location-aware content
const contentOptions = {
    enableHighAccuracy: false,
    timeout: 5000,
    maximumAge: 60000 // 1 minute
};

// Battery-saving options for approximate location
const batterySavingOptions = {
    enableHighAccuracy: false,
    timeout: 10000,
    maximumAge: 300000 // 5 minutes
};

// One-time location check
function getApproximateLocation() {
    navigator.geolocation.getCurrentPosition(
        successCallback,
        errorCallback,
        batterySavingOptions
    );
}

// Continuous tracking for navigation
function startPreciseTracking() {
    return navigator.geolocation.watchPosition(
        successCallback,
        errorCallback,
        navigationOptions
    );
}

// Location-aware content
function loadNearbyContent() {
    navigator.geolocation.getCurrentPosition(
        successCallback,
        errorCallback,
        contentOptions
    );
}</code></pre>
                        
                        <div class="info-box">
                            <h4>Accuracy vs. Battery Life</h4>
                            <p>There's always a trade-off between location accuracy and battery consumption:</p>
                            <table>
                                <tr>
                                    <th>Setting</th>
                                    <th>Accuracy</th>
                                    <th>Battery Impact</th>
                                    <th>Best For</th>
                                </tr>
                                <tr>
                                    <td><code>enableHighAccuracy: true</code></td>
                                    <td>High (5-10 meters)</td>
                                    <td>High</td>
                                    <td>Navigation, fitness tracking</td>
                                </tr>
                                <tr>
                                    <td><code>enableHighAccuracy: false</code></td>
                                    <td>Medium (100-1000 meters)</td>
                                    <td>Low</td>
                                    <td>Weather, local news, city-level services</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>Error Handling</h2>
                        <p>Proper error handling is crucial when working with the Geolocation API, as there are several reasons why location retrieval might fail.</p>
                        
                        <h3>Error Types</h3>
                        <p>The error object passed to the error callback has a <code>code</code> property that indicates the type of error:</p>
                        
                        <pre><code class="language-javascript">function handleLocationError(error) {
    switch(error.code) {
        case error.PERMISSION_DENIED:
            // Error code 1: User denied permission
            console.error("Location access denied by user.");
            showUserMessage("You've denied location access. To use this feature, please allow location access in your browser settings.");
            showLocationPermissionInstructions();
            break;
            
        case error.POSITION_UNAVAILABLE:
            // Error code 2: Location information unavailable
            console.error("Location information unavailable.");
            showUserMessage("We couldn't determine your location. Please check your device's location services or try again later.");
            offerManualLocationEntry();
            break;
            
        case error.TIMEOUT:
            // Error code 3: Location request timed out
            console.error("Location request timed out.");
            showUserMessage("Location request timed out. Please check your internet connection and try again.");
            retryWithLowerAccuracy();
            break;
            
        case error.UNKNOWN_ERROR:
            // Error code 0: Unknown error
            console.error("Unknown location error occurred.");
            showUserMessage("An unknown error occurred while trying to access your location.");
            offerAlternativeOptions();
            break;
    }
    
    // Log additional error information if available
    if (error.message) {
        console.error("Error details:", error.message);
    }
}</code></pre>
                        
                        <h3>Handling Permission Denied</h3>
                        <p>The most common error is <code>PERMISSION_DENIED</code>, which occurs when the user denies the location permission request. It's important to handle this gracefully:</p>
                        
                        <pre><code class="language-javascript">function handlePermissionDenied() {
    // Check if this is a permanent denial (varies by browser)
    navigator.permissions.query({ name: 'geolocation' }).then(permissionStatus => {
        if (permissionStatus.state === 'denied') {
            // Permanent denial - show instructions to change browser settings
            showPermissionSettings();
        } else {
            // Temporary denial - user can be prompted again later
            showWhyWeNeedLocation();
        }
    });
}

function showPermissionSettings() {
    const message = document.getElementById('location-message');
    message.innerHTML = `
        <h3>Location Access Required</h3>
        <p>You've blocked location access for this site. To use this feature, please update your settings:</p>
        <div class="browser-instructions">
            <h4>Chrome</h4>
            <ol>
                <li>Click the lock/info icon in the address bar</li>
                <li>Select "Site settings"</li>
                <li>Change "Location" to "Allow"</li>
            </ol>
            
            <h4>Firefox</h4>
            <ol>
                <li>Click the shield icon in the address bar</li>
                <li>Go to "Permissions"</li>
                <li>Change "Access Your Location" setting</li>
            </ol>
            
            <h4>Safari</h4>
            <ol>
                <li>Go to Safari Preferences</li>
                <li>Select "Websites" tab, then "Location"</li>
                <li>Find this website and change the permission</li>
            </ol>
        </div>
        <button id="retry-location">Try Again</button>
        <button id="manual-location">Enter Location Manually</button>
    `;
}</code></pre>
                        
                        <h3>Fallback Strategies</h3>
                        <p>Always provide fallback options when geolocation fails:</p>
                        
                        <pre><code class="language-javascript">// Retry with lower accuracy
function retryWithLowerAccuracy() {
    console.log("Retrying with lower accuracy settings");
    navigator.geolocation.getCurrentPosition(
        successCallback,
        function(error) {
            // If it still fails, offer manual entry
            console.error("Location still unavailable even with lower accuracy");
            offerManualLocationEntry();
        },
        { 
            enableHighAccuracy: false, 
            timeout: 15000, 
            maximumAge: 300000 // Accept positions up to 5 minutes old
        }
    );
}

// Allow manual location entry
function offerManualLocationEntry() {
    const locationForm = document.getElementById('manual-location-form');
    locationForm.style.display = 'block';
    
    document.getElementById('submit-location').addEventListener('click', function() {
        const city = document.getElementById('city-input').value;
        const country = document.getElementById('country-input').value;
        
        if (city && country) {
            // Use a geocoding service to convert address to coordinates
            geocodeAddress(city, country);
        }
    });
}

// Use IP-based geolocation as fallback
function useIpBasedLocation() {
    console.log("Falling back to IP-based geolocation");
    
    // This would typically be a server-side API call
    fetch('https://ipapi.co/json/')
        .then(response => response.json())
        .then(data => {
            console.log("IP-based location:", data);
            
            if (data.latitude && data.longitude) {
                // Use the approximate location
                const position = {
                    coords: {
                        latitude: data.latitude,
                        longitude: data.longitude,
                        accuracy: 10000 // Very low accuracy (10km)
                    }
                };
                
                successCallback(position);
            } else {
                offerManualLocationEntry();
            }
        })
        .catch(error => {
            console.error("IP geolocation failed:", error);
            offerManualLocationEntry();
        });
}</code></pre>
                        
                        <div class="info-box">
                            <h4>User Experience Best Practices</h4>
                            <ul>
                                <li>Always explain why you need location before requesting it</li>
                                <li>Provide clear error messages that explain what went wrong</li>
                                <li>Offer helpful instructions for resolving permission issues</li>
                                <li>Include multiple fallback options (lower accuracy, IP-based, manual entry)</li>
                                <li>Remember the user's choice and don't repeatedly request permission if denied</li>
                                <li>Consider providing a "Try Again" button for temporary errors</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>Integrating with Maps</h2>
                        <p>One of the most common uses of the Geolocation API is to display the user's location on a map. Let's explore how to integrate geolocation with popular mapping libraries.</p>
                        
                        <h3>Using Geolocation with Google Maps</h3>
                        <pre><code class="language-html">&lt;!-- Include Google Maps JavaScript API --&gt;
&lt;script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"&gt;&lt;/script&gt;

&lt;div id="map" style="height: 400px; width: 100%;"&gt;&lt;/div&gt;

&lt;script&gt;
    // Initialize the map
    let map;
    let userMarker;
    
    function initMap() {
        // Create a map centered on a default location
        map = new google.maps.Map(document.getElementById('map'), {
            center: { lat: 0, lng: 0 },
            zoom: 2
        });
        
        // Try to get the user's location
        if ('geolocation' in navigator) {
            navigator.geolocation.getCurrentPosition(
                // Success callback
                function(position) {
                    const userLocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };
                    
                    // Center the map on the user's location
                    map.setCenter(userLocation);
                    map.setZoom(15);
                    
                    // Add a marker for the user's location
                    userMarker = new google.maps.Marker({
                        position: userLocation,
                        map: map,
                        title: 'Your Location',
                        icon: {
                            path: google.maps.SymbolPath.CIRCLE,
                            scale: 10,
                            fillColor: '#4285F4',
                            fillOpacity: 1,
                            strokeColor: '#FFFFFF',
                            strokeWeight: 2
                        }
                    });
                    
                    // Add an accuracy circle
                    const accuracyCircle = new google.maps.Circle({
                        map: map,
                        center: userLocation,
                        radius: position.coords.accuracy,
                        fillColor: '#4285F4',
                        fillOpacity: 0.15,
                        strokeColor: '#4285F4',
                        strokeOpacity: 0.3,
                        strokeWeight: 1
                    });
                    
                    // Show location info
                    document.getElementById('accuracy').textContent = 
                        `Accuracy: ${position.coords.accuracy.toFixed(2)} meters`;
                },
                // Error callback
                function(error) {
                    console.error("Error getting location:", error.message);
                    handleLocationError(error);
                },
                // Options
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
            
            // Set up location tracking
            const trackingButton = document.getElementById('track-location');
            let watchId = null;
            
            trackingButton.addEventListener('click', function() {
                if (watchId === null) {
                    // Start tracking
                    watchId = navigator.geolocation.watchPosition(
                        function(position) {
                            const newLocation = {
                                lat: position.coords.latitude,
                                lng: position.coords.longitude
                            };
                            
                            // Update marker position
                            if (userMarker) {
                                userMarker.setPosition(newLocation);
                            }
                            
                            // Optionally follow the user
                            map.panTo(newLocation);
                            
                            // Update location info
                            document.getElementById('accuracy').textContent = 
                                `Accuracy: ${position.coords.accuracy.toFixed(2)} meters`;
                        },
                        function(error) {
                            console.error("Tracking error:", error.message);
                            stopTracking();
                        },
                        {
                            enableHighAccuracy: true,
                            timeout: 10000,
                            maximumAge: 0
                        }
                    );
                    
                    trackingButton.textContent = 'Stop Tracking';
                } else {
                    // Stop tracking
                    stopTracking();
                }
            });
            
            function stopTracking() {
                if (watchId !== null) {
                    navigator.geolocation.clearWatch(watchId);
                    watchId = null;
                    trackingButton.textContent = 'Track My Location';
                }
            }
        } else {
            // Geolocation not supported
            document.getElementById('map').innerHTML = 
                '<div class="error-message">Geolocation is not supported by your browser</div>';
        }
    }
    
    // Initialize the map when the page loads
    window.onload = initMap;
&lt;/script&gt;</code></pre>
                        
                        <h3>Using Geolocation with Leaflet (Open Source)</h3>
                        <pre><code class="language-html">&lt;!-- Include Leaflet CSS and JavaScript --&gt;
&lt;link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" /&gt;
&lt;script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"&gt;&lt;/script&gt;

&lt;div id="map" style="height: 400px; width: 100%;"&gt;&lt;/div&gt;
&lt;div id="location-info"&gt;&lt;/div&gt;
&lt;button id="locate-me"&gt;Find My Location&lt;/button&gt;

&lt;script&gt;
    // Initialize the map
    const map = L.map('map').setView([0, 0], 2);
    
    // Add OpenStreetMap tiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);
    
    // Variables for user location
    let userMarker;
    let accuracyCircle;
    
    // Handle the locate me button
    document.getElementById('locate-me').addEventListener('click', function() {
        if ('geolocation' in navigator) {
            // Show loading indicator
            this.textContent = 'Locating...';
            this.disabled = true;
            
            navigator.geolocation.getCurrentPosition(
                // Success callback
                function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const accuracy = position.coords.accuracy;
                    
                    // Center map on user's location
                    map.setView([lat, lng], 16);
                    
                    // Remove existing marker and circle
                    if (userMarker) {
                        map.removeLayer(userMarker);
                    }
                    if (accuracyCircle) {
                        map.removeLayer(accuracyCircle);
                    }
                    
                    // Add marker for user's location
                    userMarker = L.marker([lat, lng]).addTo(map)
                        .bindPopup('You are here').openPopup();
                    
                    // Add circle showing accuracy
                    accuracyCircle = L.circle([lat, lng], {
                        radius: accuracy,
                        color: '#4285F4',
                        fillColor: '#4285F4',
                        fillOpacity: 0.15,
                        weight: 1
                    }).addTo(map);
                    
                    // Show location info
                    document.getElementById('location-info').innerHTML = `
                        <p><strong>Latitude:</strong> ${lat.toFixed(6)}</p>
                        <p><strong>Longitude:</strong> ${lng.toFixed(6)}</p>
                        <p><strong>Accuracy:</strong> ${accuracy.toFixed(2)} meters</p>
                    `;
                    
                    // Reset button
                    document.getElementById('locate-me').textContent = 'Update My Location';
                    document.getElementById('locate-me').disabled = false;
                },
                // Error callback
                function(error) {
                    console.error("Location error:", error.message);
                    
                    let errorMessage = 'Location error: ';
                    
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage += 'Permission denied. Please enable location services.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage += 'Location information unavailable.';
                            break;
                        case error.TIMEOUT:
                            errorMessage += 'Location request timed out.';
                            break;
                        default:
                            errorMessage += 'Unknown error occurred.';
                    }
                    
                    document.getElementById('location-info').innerHTML = 
                        `<p class="error">${errorMessage}</p>`;
                    
                    // Reset button
                    document.getElementById('locate-me').textContent = 'Try Again';
                    document.getElementById('locate-me').disabled = false;
                },
                // Options
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        } else {
            alert('Geolocation is not supported by your browser');
        }
    });
&lt;/script&gt;</code></pre>
                        
                        <h3>Reverse Geocoding</h3>
                        <p>Reverse geocoding converts coordinates (latitude and longitude) into a human-readable address. This is useful for showing the user their current location in a more understandable format.</p>
                        
                        <pre><code class="language-javascript">// Reverse geocoding with Google Maps Geocoding API
function reverseGeocode(latitude, longitude) {
    const geocoder = new google.maps.Geocoder();
    const latlng = { lat: parseFloat(latitude), lng: parseFloat(longitude) };
    
    geocoder.geocode({ location: latlng }, function(results, status) {
        if (status === 'OK') {
            if (results[0]) {
                console.log('Address:', results[0].formatted_address);
                
                // Display the address to the user
                document.getElementById('address').textContent = 
                    results[0].formatted_address;
                
                // You can also extract specific components
                const addressComponents = results[0].address_components;
                let city, state, country;
                
                for (let component of addressComponents) {
                    if (component.types.includes('locality')) {
                        city = component.long_name;
                    } else if (component.types.includes('administrative_area_level_1')) {
                        state = component.long_name;
                    } else if (component.types.includes('country')) {
                        country = component.long_name;
                    }
                }
                
                console.log(`City: ${city}, State: ${state}, Country: ${country}`);
            } else {
                console.log('No results found');
            }
        } else {
            console.error('Geocoder failed due to:', status);
        }
    });
}

// Alternative: Using a free service like Nominatim (OpenStreetMap)
// Note: For production use, you should host your own instance or use a paid service
function reverseGeocodeWithNominatim(latitude, longitude) {
    const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=18&addressdetails=1`;
    
    fetch(url, {
        headers: {
            'Accept': 'application/json',
            'User-Agent': 'YourAppName/1.0' // Required by Nominatim's usage policy
        }
    })
    .then(response => response.json())
    .then(data => {
        console.log('Address:', data.display_name);
        
        // Display the address to the user
        document.getElementById('address').textContent = data.display_name;
        
        // Access specific address components
        const address = data.address;
        console.log(`City: ${address.city || address.town || address.village}, Country: ${address.country}`);
    })
    .catch(error => {
        console.error('Reverse geocoding failed:', error);
    });
}</code></pre>
                        
                        <div class="info-box">
                            <h4>Map Integration Tips</h4>
                            <ul>
                                <li>Always include error handling and loading states in map implementations</li>
                                <li>Consider using clustering for multiple markers to improve performance</li>
                                <li>Implement responsive designs for maps to work well on mobile devices</li>
                                <li>Be mindful of API usage limits and costs for mapping and geocoding services</li>
                                <li>Cache geocoding results when appropriate to reduce API calls</li>
                                <li>Consider privacy when displaying user locations on shared or public maps</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>Geofencing</h2>
                        <p>Geofencing is a location-based service that triggers actions when a device enters or exits a predefined virtual boundary (geofence). While there isn't a dedicated Geofencing API in browsers yet, you can implement basic geofencing using the Geolocation API.</p>
                        
                        <h3>Basic Geofencing Implementation</h3>
                        <pre><code class="language-javascript">// Define geofence areas
const geofences = [
    {
        id: 'office',
        name: 'Office Building',
        center: { lat: 37.7749, lng: -122.4194 },
        radius: 100, // meters
        events: {
            enter: function() {
                console.log('Entered office area');
                showNotification('Welcome to the office!');
                // Trigger other actions like automatic check-in
            },
            exit: function() {
                console.log('Left office area');
                showNotification('Goodbye! Have a nice day!');
                // Trigger other actions like automatic check-out
            }
        }
    },
    {
        id: 'home',
        name: 'Home',
        center: { lat: 37.7739, lng: -122.4312 },
        radius: 50, // meters
        events: {
            enter: function() {
                console.log('Arrived home');
                showNotification('Welcome home!');
                // Trigger home automation, etc.
            },
            exit: function() {
                console.log('Left home');
                // Trigger other actions
            }
        }
    }
];

// Track user's location and check geofences
let watchId;
let insideGeofences = {}; // Track which geofences the user is currently inside

function startGeofencing() {
    // Initialize all geofences as "outside"
    geofences.forEach(fence => {
        insideGeofences[fence.id] = false;
    });
    
    // Start tracking location
    watchId = navigator.geolocation.watchPosition(
        // Success callback
        function(position) {
            const userLat = position.coords.latitude;
            const userLng = position.coords.longitude;
            
            // Check each geofence
            geofences.forEach(fence => {
                // Calculate distance from fence center
                const distance = calculateDistance(
                    userLat, 
                    userLng, 
                    fence.center.lat, 
                    fence.center.lng
                );
                
                // Check if user is inside the fence (accounting for accuracy)
                const effectiveRadius = fence.radius + position.coords.accuracy;
                const isInside = distance <= effectiveRadius;
                
                // Detect enter/exit events
                if (isInside && !insideGeofences[fence.id]) {
                    // User has entered the geofence
                    insideGeofences[fence.id] = true;
                    fence.events.enter();
                } else if (!isInside && insideGeofences[fence.id]) {
                    // User has exited the geofence
                    insideGeofences[fence.id] = false;
                    fence.events.exit();
                }
            });
        },
        // Error callback
        function(error) {
            console.error('Geofencing error:', error.message);
        },
        // Options
        {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 0
        }
    );
    
    return watchId;
}

function stopGeofencing() {
    if (watchId) {
        navigator.geolocation.clearWatch(watchId);
        watchId = null;
    }
}

// Helper function to show notifications
function showNotification(message) {
    // Check if the Notifications API is supported and permission is granted
    if ('Notification' in window && Notification.permission === 'granted') {
        new Notification('Location Alert', {
            body: message,
            icon: '/path/to/icon.png'
        });
    } else {
        // Fallback to an in-app notification
        const notification = document.createElement('div');
        notification.className = 'in-app-notification';
        notification.textContent = message;
        document.body.appendChild(notification);
        
        // Remove after 5 seconds
        setTimeout(() => {
            notification.remove();
        }, 5000);
    }
}</code></pre>
                        
                        <h3>Visualizing Geofences on a Map</h3>
                        <pre><code class="language-javascript">// Add geofences to a Google Map
function addGeofencesToMap(map) {
    const geofenceCircles = [];
    
    geofences.forEach(fence => {
        // Create a circle for each geofence
        const circle = new google.maps.Circle({
            map: map,
            center: fence.center,
            radius: fence.radius,
            fillColor: '#FF9800',
            fillOpacity: 0.35,
            strokeColor: '#FF9800',
            strokeOpacity: 0.8,
            strokeWeight: 2,
            clickable: true
        });
        
        // Add info window
        const infoWindow = new google.maps.InfoWindow({
            content: `<strong>${fence.name}</strong><br>Radius: ${fence.radius}m`
        });
        
        // Show info window when clicking on the geofence
        circle.addListener('click', function() {
            infoWindow.setPosition(fence.center);
            infoWindow.open(map);
        });
        
        geofenceCircles.push(circle);
    });
    
    return geofenceCircles;
}

// Update geofence visualization based on user's location
function updateGeofenceStatus(map, userPosition) {
    geofences.forEach((fence, index) => {
        const distance = calculateDistance(
            userPosition.lat,
            userPosition.lng,
            fence.center.lat,
            fence.center.lng
        );
        
        // Update circle color based on whether user is inside
        const isInside = distance <= fence.radius;
        const circle = geofenceCircles[index];
        
        if (isInside) {
            // User is inside - highlight the geofence
            circle.setOptions({
                fillColor: '#4CAF50',
                strokeColor: '#4CAF50'
            });
        } else {
            // User is outside - use default color
            circle.setOptions({
                fillColor: '#FF9800',
                strokeColor: '#FF9800'
            });
        }
    });
}</code></pre>
                        
                        <h3>Advanced Geofencing Considerations</h3>
                        <ul>
                            <li><strong>Accuracy and Battery Life</strong>: Balance the frequency of location updates with battery consumption</li>
                            <li><strong>Dwell Time</strong>: Consider implementing a minimum time threshold before triggering enter/exit events to avoid false positives</li>
                            <li><strong>Hysteresis</strong>: Add a buffer zone to prevent rapid toggling between states when near the boundary</li>
                            <li><strong>Background Operation</strong>: Web-based geofencing only works when the page is open; for continuous monitoring, consider a native app approach</li>
                        </ul>
                        
                        <pre><code class="language-javascript">// Improved geofencing with dwell time and hysteresis
function enhancedGeofencing() {
    const geofenceStates = {};
    const dwellTime = 10000; // 10 seconds
    const hysteresisBuffer = 10; // 10 meters
    
    // Initialize states
    geofences.forEach(fence => {
        geofenceStates[fence.id] = {
            inside: false,
            pending: false,
            timer: null,
            lastEvent: null
        };
    });
    
    return navigator.geolocation.watchPosition(
        function(position) {
            const userLat = position.coords.latitude;
            const userLng = position.coords.longitude;
            
            geofences.forEach(fence => {
                const state = geofenceStates[fence.id];
                const distance = calculateDistance(
                    userLat, userLng, 
                    fence.center.lat, fence.center.lng
                );
                
                // Apply hysteresis buffer
                let effectiveRadius = fence.radius;
                if (state.inside) {
                    // If already inside, expand the radius to exit
                    effectiveRadius += hysteresisBuffer;
                }
                
                const isInside = distance <= effectiveRadius;
                
                // Handle state changes with dwell time
                if (isInside !== state.inside) {
                    // State is changing
                    if (!state.pending) {
                        // Start the dwell timer
                        state.pending = true;
                        
                        // Clear any existing timer
                        if (state.timer) {
                            clearTimeout(state.timer);
                        }
                        
                        state.timer = setTimeout(() => {
                            // Timer completed, update the state
                            state.inside = isInside;
                            state.pending = false;
                            
                            // Trigger the appropriate event
                            if (isInside) {
                                fence.events.enter();
                            } else {
                                fence.events.exit();
                            }
                            
                            state.lastEvent = new Date().getTime();
                        }, dwellTime);
                    }
                } else {
                    // State is stable, cancel any pending changes
                    if (state.pending) {
                        clearTimeout(state.timer);
                        state.pending = false;
                    }
                }
            });
        },
        function(error) {
            console.error('Enhanced geofencing error:', error.message);
        },
        {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 0
        }
    );
}</code></pre>
                        
                        <div class="info-box">
                            <h4>Geofencing Use Cases</h4>
                            <p>Geofencing can be used for various applications:</p>
                            <ul>
                                <li><strong>Retail</strong>: Send special offers when customers are near a store</li>
                                <li><strong>Events</strong>: Provide event-specific information when attendees arrive</li>
                                <li><strong>Tourism</strong>: Deliver information about landmarks when tourists approach them</li>
                                <li><strong>Workforce Management</strong>: Automate check-in/check-out for field workers</li>
                                <li><strong>Home Automation</strong>: Trigger smart home actions when residents arrive or leave</li>
                                <li><strong>Safety</strong>: Alert parents when children leave designated safe areas</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>Privacy and Security</h2>
                        <p>Location data is sensitive personal information, so it's crucial to handle it responsibly and securely.</p>
                        
                        <h3>Privacy Considerations</h3>
                        <ul>
                            <li><strong>Transparency</strong>: Clearly explain why you need location data and how it will be used</li>
                            <li><strong>Consent</strong>: Only request location when the user has given explicit consent</li>
                            <li><strong>Data Minimization</strong>: Only collect the location data you actually need</li>
                            <li><strong>Retention</strong>: Don't store location data longer than necessary</li>
                            <li><strong>Security</strong>: Protect location data with appropriate security measures</li>
                            <li><strong>Control</strong>: Allow users to delete their location history</li>
                        </ul>
                        
                        <h3>Implementing Privacy Best Practices</h3>
                        <pre><code class="language-javascript">// Privacy-focused geolocation implementation
const LocationService = {
    // Store user preferences
    preferences: {
        // Load from localStorage or use defaults
        highAccuracy: localStorage.getItem('locationHighAccuracy') === 'true' || false,
        retentionDays: parseInt(localStorage.getItem('locationRetentionDays') || '7'),
        shareWithThirdParties: localStorage.getItem('locationShareThirdParties') === 'true' || false
    },
    
    // Show privacy notice and request permission
    requestPermission: function() {
        return new Promise((resolve, reject) => {
            // Show privacy notice
            const confirmed = confirm(
                'This app would like to access your location to provide location-based services. ' +
                'Your location data will be stored for ' + this.preferences.retentionDays + ' days ' +
                'and will ' + (this.preferences.shareWithThirdParties ? '' : 'not ') + 'be shared with third parties. ' +
                'You can change these settings in your account preferences. ' +
                'Do you want to allow location access?'
            );
            
            if (confirmed) {
                // Request geolocation permission
                navigator.geolocation.getCurrentPosition(
                    position => {
                        // Log consent with timestamp
                        this.logConsent();
                        resolve(position);
                    },
                    error => {
                        reject(error);
                    },
                    {
                        enableHighAccuracy: this.preferences.highAccuracy
                    }
                );
            } else {
                reject(new Error('Permission denied by user'));
            }
        });
    },
    
    // Log user consent
    logConsent: function() {
        const consentLog = {
            timestamp: new Date().toISOString(),
            preferences: { ...this.preferences }
        };
        
        // Store consent log
        let consentHistory = JSON.parse(localStorage.getItem('locationConsentHistory') || '[]');
        consentHistory.push(consentLog);
        localStorage.setItem('locationConsentHistory', JSON.stringify(consentHistory));
    },
    
    // Save location with privacy controls
    saveLocation: function(position) {
        // Create location object with timestamp
        const locationData = {
            latitude: position.coords.latitude,
            longitude: position.coords.longitude,
            accuracy: position.coords.accuracy,
            timestamp: new Date().toISOString()
        };
        
        // Get existing location history
        let locationHistory = JSON.parse(localStorage.getItem('locationHistory') || '[]');
        
        // Add new location
        locationHistory.push(locationData);
        
        // Apply retention policy
        if (this.preferences.retentionDays > 0) {
            const cutoffDate = new Date();
            cutoffDate.setDate(cutoffDate.getDate() - this.preferences.retentionDays);
            
            // Filter out locations older than retention period
            locationHistory = locationHistory.filter(location => {
                return new Date(location.timestamp) >= cutoffDate;
            });
        }
        
        // Save updated history
        localStorage.setItem('locationHistory', JSON.stringify(locationHistory));
        
        return locationData;
    },
    
    // Delete all location history
    deleteLocationHistory: function() {
        localStorage.removeItem('locationHistory');
        alert('Your location history has been deleted.');
    },
    
    // Update privacy preferences
    updatePreferences: function(newPreferences) {
        this.preferences = { ...this.preferences, ...newPreferences };
        
        // Save to localStorage
        localStorage.setItem('locationHighAccuracy', this.preferences.highAccuracy);
        localStorage.setItem('locationRetentionDays', this.preferences.retentionDays);
        localStorage.setItem('locationShareThirdParties', this.preferences.shareWithThirdParties);
        
        // Log the preference change
        this.logConsent();
    }
};

// Example usage
document.getElementById('location-permission').addEventListener('click', async function() {
    try {
        const position = await LocationService.requestPermission();
        const locationData = LocationService.saveLocation(position);
        showLocationOnMap(locationData);
    } catch (error) {
        console.error('Location error:', error.message);
        showFallbackOptions();
    }
});

// Privacy settings form
document.getElementById('privacy-form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    LocationService.updatePreferences({
        highAccuracy: document.getElementById('high-accuracy').checked,
        retentionDays: parseInt(document.getElementById('retention-days').value),
        shareWithThirdParties: document.getElementById('share-third-parties').checked
    });
    
    alert('Privacy preferences updated');
});</code></pre>
                        
                        <h3>Security Considerations</h3>
                        <ul>
                            <li><strong>HTTPS</strong>: The Geolocation API requires a secure context (HTTPS) in modern browsers</li>
                            <li><strong>Data Transmission</strong>: Encrypt location data when sending it to your server</li>
                            <li><strong>Server Storage</strong>: Use appropriate security measures for storing location data on your server</li>
                            <li><strong>Access Control</strong>: Implement proper authentication and authorization for accessing location data</li>
                            <li><strong>Third Parties</strong>: Be cautious about sharing location data with third-party services</li>
                        </ul>
                        
                        <pre><code class="language-javascript">// Secure transmission of location data
async function securelyTransmitLocation(position) {
    try {
        // Create a location object
        const locationData = {
            latitude: position.coords.latitude,
            longitude: position.coords.longitude,
            accuracy: position.coords.accuracy,
            timestamp: new Date().toISOString(),
            userId: getUserId() // Get authenticated user ID
        };
        
        // Add a signature or token for verification
        locationData.authToken = getAuthToken();
        
        // Send data to server using HTTPS
        const response = await fetch('https://example.com/api/location', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${getAuthToken()}`
            },
            body: JSON.stringify(locationData)
        });
        
        if (!response.ok) {
            throw new Error('Failed to send location data');
        }
        
        return await response.json();
    } catch (error) {
        console.error('Error sending location data:', error);
        // Handle the error appropriately
    }
}</code></pre>
                        
                        <div class="info-box">
                            <h4>Legal Considerations</h4>
                            <p>Be aware of legal requirements for collecting and processing location data:</p>
                            <ul>
                                <li><strong>GDPR</strong> (EU): Location data is considered personal data and subject to GDPR requirements</li>
                                <li><strong>CCPA</strong> (California): Users have the right to know what data is collected and request deletion</li>
                                <li><strong>COPPA</strong> (US): Special requirements for collecting location data from children under 13</li>
                                <li><strong>Privacy Policies</strong>: Your privacy policy must disclose location data collection and usage</li>
                                <li><strong>Data Breach Notification</strong>: Many jurisdictions require notification if location data is compromised</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>Practice Exercise: Building a Location-Based Weather App</h2>
                        <p>Let's create a practical application that uses the Geolocation API to provide weather information based on the user's current location.</p>
                        
                        <h3>Exercise: Create a Weather App</h3>
                        <p>Build a weather application with the following features:</p>
                        <ul>
                            <li>Get the user's current location using the Geolocation API</li>
                            <li>Fetch weather data for that location from a weather API</li>
                            <li>Display current weather conditions and forecast</li>
                            <li>Allow manual location entry as a fallback</li>
                            <li>Implement proper error handling and loading states</li>
                        </ul>
                        
                        <p>Start with this template and enhance it:</p>
                        
                        <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Weather App&lt;/title&gt;
    &lt;style&gt;
        /* Add your styles here */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        h1, h2 {
            color: #3366ff;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* Add more styles for your app */
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="container"&gt;
        &lt;h1&gt;Weather App&lt;/h1&gt;
        
        &lt;div class="location-container"&gt;
            &lt;button id="get-location"&gt;Get My Location&lt;/button&gt;
            &lt;div id="location-status"&gt;&lt;/div&gt;
            
            &lt;div class="manual-location"&gt;
                &lt;h3&gt;Or enter location manually:&lt;/h3&gt;
                &lt;input type="text" id="city-input" placeholder="Enter city name"&gt;
                &lt;button id="search-city"&gt;Search&lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        
        &lt;div id="weather-container" class="weather-container"&gt;
            &lt;!-- Weather data will be displayed here --&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;script&gt;
        // Add your JavaScript here
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize the app
            initApp();
            
            // Add event listeners
            document.getElementById('get-location').addEventListener('click', getLocation);
            document.getElementById('search-city').addEventListener('click', searchCity);
        });
        
        function initApp() {
            // Initialize your app
        }
        
        function getLocation() {
            // Get user's location
        }
        
        function searchCity() {
            // Search for weather by city name
        }
        
        function getWeatherData(lat, lon) {
            // Fetch weather data for the given coordinates
        }
        
        function displayWeather(data) {
            // Display weather data
        }
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        
                        <div class="try-it-box">
                            <h4>Challenge Yourself</h4>
                            <p>Enhance the template with:</p>
                            <ol>
                                <li>Complete Geolocation API implementation with proper error handling</li>
                                <li>Integration with a weather API (like OpenWeatherMap, which offers a free tier)</li>
                                <li>Current weather display with temperature, conditions, humidity, wind speed, etc.</li>
                                <li>5-day forecast display</li>
                                <li>Loading indicators and error messages</li>
                                <li>Reverse geocoding to show the user's city name</li>
                                <li>Unit conversion (Celsius/Fahrenheit)</li>
                                <li>Weather icons or animations based on conditions</li>
                                <li>Responsive design that works well on both desktop and mobile devices</li>
                            </ol>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2>Summary</h2>
                        <p>In this lesson, we've explored the Geolocation API, which allows web applications to access the user's geographical location:</p>
                        <ul>
                            <li><strong>Basic Geolocation</strong>: Getting the user's current position with <code>getCurrentPosition()</code></li>
                            <li><strong>Tracking Position</strong>: Continuously monitoring the user's location with <code>watchPosition()</code></li>
                            <li><strong>Geolocation Options</strong>: Customizing location retrieval with options like <code>enableHighAccuracy</code></li>
                            <li><strong>Error Handling</strong>: Properly handling permission denials and other geolocation errors</li>
                            <li><strong>Map Integration</strong>: Displaying location data on maps using libraries like Google Maps or Leaflet</li>
                            <li><strong>Geofencing</strong>: Implementing virtual boundaries to trigger actions when users enter or exit areas</li>
                            <li><strong>Privacy and Security</strong>: Handling location data responsibly and securely</li>
                        </ul>
                        
                        <p>The Geolocation API enables a wide range of location-based features in web applications, from simple "find my location" functionality to complex navigation and tracking systems. By understanding how to use this API effectively and responsibly, you can create more personalized and contextually relevant experiences for your users.</p>
                        
                        <p>Remember these key points:</p>
                        <ul>
                            <li><strong>Always check for support</strong> before using the Geolocation API</li>
                            <li><strong>Explain to users why</strong> you need their location before requesting it</li>
                            <li><strong>Provide fallbacks</strong> for when location access is denied or unavailable</li>
                            <li><strong>Consider battery impact</strong> when using high-accuracy or continuous tracking</li>
                            <li><strong>Handle location data</strong> with appropriate privacy and security measures</li>
                            <li><strong>Test on real devices</strong> as location behavior can vary between browsers and devices</li>
                        </ul>
                        
                        <p>In the next lesson, we'll explore the Drag and Drop API, which allows users to drag elements and drop them onto other elements.</p>
                    </div>
                    
                    <!-- Navigation Buttons -->
                    <div class="page-navigation">
                        <a href="page18.html" class="btn">Previous: Web Storage</a>
                        <a href="page20.html" class="btn">Next: Drag & Drop API</a>
                    </div>
                </section>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <div>
                    <div class="footer-logo">
                        <img src="../../../assets/images/logo.svg" alt="HTML & CSS Mastery">
                        <h2>HTML & CSS Mastery</h2>
                    </div>
                    <p>A comprehensive guide to modern web development with a futuristic aesthetic approach.</p>
                </div>
                <div>
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="../../../index.html">Home</a></li>
                        <li><a href="../basic/page1.html">HTML Basics</a></li>
                        <li><a href="../professional/page13.html">Professional HTML</a></li>
                        <li><a href="../../css/basic/page26.html">CSS Basics</a></li>
                        <li><a href="../../css/professional/page38.html">Professional CSS</a></li>
                    </ul>
                </div>
                <div>
                    <h3>Resources</h3>
                    <ul>
                        <li><a href="#">HTML Reference</a></li>
                        <li><a href="#">CSS Reference</a></li>
                        <li><a href="#">Web Design Principles</a></li>
                        <li><a href="#">Accessibility Guidelines</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 HTML & CSS Mastery Course. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <!-- Scripts -->
    <script src="../../../assets/js/main.js"></script>
</body>
</html>
